---
title: 机器学习(ML)(十四) — 推荐系统探析
date: 2024-11-04 09:30:11
tags:
  - AI
categories:
  - 人工智能
mathjax:
  tex:
    tags: 'ams'
  svg:
    exFactor: 0.03
---

#### 排序 - 多目标模型

我们先回顾一下**推荐系统**的链路，分为召回，粗排、精排、重排。有很多条召回通道，从几亿个物品选出几千个物品，做完召回之后，要从中选出用户最感兴趣的物品，这就要用到粗排和精排，粗排会给召回的物品逐一打分，保留分数最高的几百个物品，然后使用精排模型给粗排选中的几百个物品打分但不做截断，让几百个物品全都带着精排分数进入重排，最后一步是重排，做多样性抽样，并且把相似内容打散，最终由几几十个物品被选中展示给用户。
<!-- more -->

**排序**的主要依据是用户对物品的兴趣，兴趣可以反映在用户与物品的交互上，对于每个物品，系统会记录下面几个统计量：**曝光次数**(`number of impressions`)，就是一个物品被展示给多少用户，展示之后，才会有点击等行为；**点击次数**(`number of clicks`)，就是一个物品被多少用户点开；**点赞次数**(`number of likes`)、**收藏次数**(`number of collects`)、**转发次数**(`number of shares`)。点击率 = 点击次数 / 曝光次数、
点赞率 = 点赞次数 / 点击次数、收藏率 = 收藏次数 / 点击次数、转发率 = 转发次数 / 点击次数。排序的依据：排序模型通过机器学习预估点击率、点赞量、收藏率、转发率等，做完预估之后，要对这些预估分数做融合（比如加权和），最后按照融合的分数对物品做排序、截断，保留分数最高的物品。

**多目标模型**：排序模型的输入是各种各样的特征，**用户特征**主要是用户`ID`和用户画像；**物品特征**主要是物品`ID`、物品画像和作者信息；**统计特征**：包括**用户统计特征**和**物品统计特征**，比如用户在过去`30`天曝光了多少物品，点击了多少物品，点赞了多少物品，比如物品在过去获得了多少次曝光、点击、点赞等等；**场景特征**：是随着用户请求传过来的，不如按当前的时间和用户所在的地点。这些信息对推荐很有用，把这些特征做融合(`concatenation`)，输入神经网咯，神经网络可以是简单的全连接网络，也可以是更复杂的结构，神经网络会输出一个向量，这个向量在输入`4`个神经网络，每个神经网络有`2-3`个全连接层和输出层的**激活函数**是`Sigmoid`，`4`个神经网络分别输出点击率、点赞率、收藏率和转发率的预估值。`4`个预估值都是实数，介于`0~1`之间，**推荐系统**排序就主要靠这4个预估值，它们反映出用户对物品的兴趣。如下图所示：
{% asset_img ml_1.png "多目标模型" %}

