---
title: 机器学习(ML)(二十一) — 强化学习探析
date: 2024-12-19 17:30:11
tags:
  - AI
categories:
  - 人工智能
mathjax:
  tex:
    tags: 'ams'
  svg:
    exFactor: 0.03
---

#### 泛化

**强化学习**(`RL`)可用于自动驾驶汽车和机器人等领域，可以在现实世界中使用**强化学习**(`RL`)算法。现实是多种多样、非平稳和开放的，为了处理各种情况，**强化学习**(`RL`)需要对环境的变化具有**鲁棒性**，并且能够在部署期间转移和适应从未见过的（但相似的）环境。**强化学习**(`RL`)中的**泛化**就是创建可以解决这些困难的方法，挑战以前的**强化学习**(`RL`)研究中的一个常见假设，即训练和测试环境是相同的。
<!-- more -->
**泛化**是指**强化学习**(`RL`)中的一类问题，而不是特定问题。第一种是单例环境，传统**强化学习**(`RL`)专注于训练和测试相同的环境；但在现实世界中，训练和测试环境会有所不同；第二种是`IID`零样本泛化环境，来自相同的分布；第三种是`OOD`零样本泛化环境，来自不同的分布。`OOD`(`Out-of-Distribution`)指的是在训练模型时未见过的数据分布。**独立同分布**(`Independent and Identically Distributed,IID`)是概率论和统计学中的一个基本概念，广泛应用于机器学习和数据分析等领域。
{% asset_img ml_1.png %}

当我们说**强化学习**中的**泛化**时，到底是什么意思呢？该领域的所有研究都是在一些任务、级别或环境中进行的，而**泛化**是通过这个集合的不同子集上训练和测进行衡量的。**上下文马尔可夫决策过程**(`CMDP`)，它可以捕捉所有这些设置。每个任务、层级或环境都是由一个上下文决定的，例如，这个上下文可以是程序内容生成过程的随机种子、任务`ID`或用于可控仿真和渲染过程的参数向量。为了测试泛化能力，要将上下文集合分为**训练集**和**测试集**。策略在训练集上进行训练，然后在测试集上进行评估，测试集通常包含从未见过的上下文，因此也包含从未见过的级别、任务或环境。**泛化**问题由**上下文马尔可夫决策过程**(`CMDP`)和训练、测试上下文集合的选择来指定。

**监督学习**中的**泛化**是一个被广泛研究的领域，比**强化学习**中的**泛化**更成熟。在**监督学习**中，一些**预测器**在训练数据集上进行训练，模型的性能在保留的测试数据集上进行评估。通常训练和测试数据集中的数据点都是从相同的底层分布中**独立同分布**(`IID`)绘制的，**泛化性能**与**测试性能**同义，因为模型需要“**泛化**”在训练期间从未见过的输入。对于训练、测试数据{% mathjax %}D_{\text{train}},D_{\text{test}}{% endmathjax %}和**损失函数**{% mathjax %}\mathcal{L}{% endmathjax %}的模型{% mathjax %}\phi{% endmathjax %}，在**监督学习**中的**泛化**差距定义为：
{% mathjax '{"conversion":{"em":14}}' %}
\text{GenGap}(\phi) = \mathbb{E}_{(x,y)\sim D_{\text{test}}}[\mathcal{L}(\phi,x,y)] - \mathbb{E}_{(x,y)\sim D_{\text{train}}}[\mathcal{L}(\phi,x,y)]
{% endmathjax %}
这种**差距**通常被作为**泛化**的衡量标准，与训练或测试性能无关：对于给定的训练性能指标，**差距**越小意味着模型的**泛化**能力越好。这个指标并不完美，因为在训练和测试中随机表现模型的差距为`0`。此外，如果训练和测试数据集不是`IID`绘制的，那么测试数据集可能更容易（或更难），因此差距为`0`并不意味着泛化很好。但是，它可以用于衡量跨基准的**泛化性能**，其中绝对性能无法比较，或通过降低差距而不改变测试性能（实际上是通过降低训练性能）来激励可能改善**泛化**方法的改进。这些方法可以与提高训练性能的方法相结合，以提高整体测试性能，假设这些方法不冲突。引入这个指标是为了完整性，因为它经常在文献中用于测试性能。总之，它作为测试的补充指标很有用，但不能替代。在**监督学习**中经常研究的一种与**强化学习**(`RL`)相关的**泛化**是**组合泛化**。虽然这是为**语言泛化**而设计的，但其中许多形态与**强化学习**(`RL`)相关。`5`种**组合泛化**形态为：
- **系统性**：通过系统地重新组合已知部分和规则实现概括。
- **生产力**：将预测扩展到训练数据中的长度之外的能力。
- **替代性**：通过用同义词替换组件的能力实现概括。
- **局部性**：模型组合操作是局部的还是全局的。
- **过度概括**：模型是否关注或对异常具有鲁棒性。

