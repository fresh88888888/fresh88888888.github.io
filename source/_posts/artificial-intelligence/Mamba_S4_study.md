---
title: 序列化建模：Mamba / S4（深度学习）
date: 2024-06-29 10:00:11
tags:
  - AI
categories:
  - 人工智能
mathjax:
  tex:
    tags: 'ams'
  svg:
    exFactor: 0.03
---

序列模型的目标是将输入序列映射到输出序列。我们可以将连续输入信号{% mathjax %}x(t){% endmathjax %}映射到输出信号{% mathjax %}y(t){% endmathjax %}，或者将离散输入序列映射到离散输出序列。
{% asset_img ms_1.png %}
<!-- more -->

例如连续信号可以是音频，离散信号可以是文本，实际上大多数时候我们都使用离散信号，即使在音频的情况下也是如此。当语言建模时，我们考虑的是离散输入，因为只有有限数量的`token`，将其映射到`token`的输出序列，我们可以选择许多模型的来进行序列建模。

第一个模型是**循环神经网络**(`RNN`)。在该网络中，我们有一个隐藏状态，按如下方式计算输出，例如我们输入的序列由{% mathjax %}x_1,x_2{% endmathjax %}和{% mathjax %}x_3{% endmathjax %}组成。初始化隐藏状态的隐藏序列使用`0`来进行初始化。我们将其插入到网络的第一个隐藏状态，因此与第一个输入组合为`0`，然后将产生第一个输出。上一步的输出将产生一个新的隐藏状态和新输入`token`，这将是{% mathjax %}y_2{% endmathjax %}，输出数为`2`。之前生成的隐藏状态与新的输入`token`，用于生成新的输出`token`，以及下一个新隐藏状态的`token`。输出的生成顺序不可以并行化，因为要生成`N`个`token`，我们需要`n-1`个节点。但是每个token的推理时间是不变的，从计算和内存的角度来看，输出中生成的`token`的是相同的。无论它是第一个`token`，还是第`100`个`token`。在这里操作和计算的数量级是一样的，理论上这个输出token拥有无限的上下文长度。但实际情况是不能的，因为它存在梯度消失和爆炸的问题。

