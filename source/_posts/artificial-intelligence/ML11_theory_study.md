---
title: 机器学习(ML)(十一) — 推荐系统探析
date: 2024-10-16 15:50:11
tags:
  - AI
categories:
  - 人工智能
mathjax:
  tex:
    tags: 'ams'
  svg:
    exFactor: 0.03
---

#### 介绍

**推荐系统**(`Recommendation system`)的商业影响和实际使用案例数量甚至远远超过学术界的关注程度。每次你访问京东`app`、淘宝`app`、美团`app`等或腾讯视频等电影流媒体网站，或者访问提供短视频(抖音、快手)应用时，这类应用都会向你推荐他们认为你可能想买的东西、他们认为你可能想看的电影或他们认为你可能想尝试的餐馆。对于许多公司来说，很大一部分销售额是由他们的**推荐系统**(`Recommendation system`)推动的。因此，对于许多公司来说，**推荐系统**(`Recommendation system`)带来的经济效益或价值非常大。因此，我们很有必要深入了解一下什么是**推荐系统**(`Recommendation system`)。
<!-- more -->

我将使用预测电影评分的应用作为示例。假设您经营一家大型电影流媒体网站，您的用户使用一到五颗星对电影进行评分。因此，在典型的**推荐系统**(`Recommendation system`)中，您有一组用户，这里有四个用户`Alice、Bob Carol`和`Dave`。用户编号为`1、2、3、4`。以及一组电影《爱在最后》、《浪漫永恒》、《可爱的小狗》、《不停歇的汽车追逐》和《剑与空手道》。用户所做的就是将这些电影评为一到五颗星。假设`Alice`给《爱在最后》评了五颗星，给《浪漫永恒》评了五颗星。也许她还没有看过《可爱的小狗》，所以没有对这部电影进行评分。则通过问号来表示，她认为《不停歇的汽车追逐》和《剑与空手道》应该得零颗星等。在**推荐系统**(`Recommendation system`)中，你有一定数量的用户和一定数量的项目。在这种情况下，**项目**是您想要推荐给用户的电影。尽管在这个例子中使用的是电影，但同样的逻辑或同样的东西也适用于任何东西，从产品或网站到餐馆，甚至推荐哪些媒体的文章、要展示的社交媒体文章，对用户感到更有趣的东西。这里使用的符号是{% mathjax %}n_u{% endmathjax %}来表示用户数量。所以在这个例子中，{% mathjax %}n_u = 4{% endmathjax %}，因为你有四个用户{% mathjax %}n_m{% endmathjax %}表示电影数量或实际上是项目数量。所以在这个例子中，{% mathjax %}n_m = 5{% endmathjax %}，因为我们有五部电影。如果用户{% mathjax %}j{% endmathjax %}对电影{% mathjax %}i{% endmathjax %}进行了评分，将设置{% mathjax %}r(i,j) = 1{% endmathjax %}。假设`Dallas Alice`对电影`1`进行了评分，但尚未对电影`3`进行评分，因此{% mathjax %}r(1,1) = 1{% endmathjax %}，因为她对电影`1`进行了评分，但{% mathjax %}r(3,1) = 0{% endmathjax %}，因为她尚未对电影`3`进行评分。最后使用{% mathjax %}y^{(i,j)}{% endmathjax %}表示用户{% mathjax %}j{% endmathjax %}对电影{% mathjax %}i{% endmathjax %}给出的评分。例如，此处的评分将是用户`2`对电影`3`的评分等于{% mathjax %}y^{(3,2)} = 4{% endmathjax %}。请注意，并非每个用户都会对每部电影进行评分，因此系统需要知道哪些用户对哪些电影进行了评分。这就是为什么用户{% mathjax %}j{% endmathjax %}对电影{% mathjax %}i{% endmathjax %}进行了评分，将定义为{% mathjax %}r(i,j) = 1{% endmathjax %}，如果用户{% mathjax %}j{% endmathjax %}尚未对电影{% mathjax %}i{% endmathjax %}进行评分，则{% mathjax %}r(i,j) = 0{% endmathjax %}。使用此**推荐系统**(`Recommendation system`)框架，解决问题的一种方法是查看用户尚未评分的电影。并尝试预测用户对这些电影的评分，因为这样我们就可以尝试向用户推荐他们更有可能评为五星的电影。

如果我们有每件商品的特征或每部电影的特征，我们该如何开发一个推荐系统？这里四个用户对五部电影中的部分电影进行了评分。在这里添加了两个特征{% mathjax %}x_1{% endmathjax %}和{% mathjax %}x_2{% endmathjax %}，它们分别表示每一部电影在多大程度上是爱情电影或动作电影。例如，《爱在最后》是一部非常浪漫的电影，所以这个特征取`0.9`，并且它不是一部动作电影。所以这个特征取`0`。《不停歇的汽车追逐》中只有一点点浪漫。所以它的值为`0.1`，但它有大量的动作。所以这个特征取值为`1.0`。这时的用户数量表示为：{% mathjax %}n_u = 4{% endmathjax %}，电影数量表示为{% mathjax %}n_m = 5{% endmathjax %}。最后引入{% mathjax %}n{% endmathjax %}来表示特征数量。因此{% mathjax %}n = 2{% endmathjax %}。有了这些特征，则第一部电影（即电影《爱在最后》）的特征为{% mathjax %}x^{(1)} = \begin{bmatrix}0.9 \\0 \end{bmatrix}{% endmathjax %}。第三部电影《可爱的小狗》的特征为{% mathjax %}x^{(3)} =  \begin{bmatrix}0.99 \\0 \end{bmatrix}{% endmathjax %}。如何预测`Alice`的电影评分。假设预测电影{% mathjax %}i{% endmathjax %}的评分为{% mathjax %}w\cdot x^{(i)} + b{% endmathjax %}。这个很像线性回归。例如，如果最终选择参数{% mathjax %}w^{(1)} =  \begin{bmatrix}5 \\0 \end{bmatrix}{% endmathjax %}并假设{% mathjax %}b^{(1)} = 0{% endmathjax %}，那么对于电影三的预测，其特征为{% mathjax %}x^{(3)} = \begin{bmatrix}0.99 \\0 \end{bmatrix}{% endmathjax %}，第一个特征为`0.99`，第二个特征为`0`。我们的预测将是{% mathjax %}w^{(1)}\cdot x^{(3)} + b^{(1)} = 4.95{% endmathjax %}。这个评分似乎很合理。看起来`Alice`对《爱在最后》和《永远的浪漫》这两部非常浪漫的电影给出了高评分，但对动作片《不停歇的汽车追逐》和《剑与空手道》给出了低评分。所以对于《可爱的小狗的爱》预测给出`4.95`分似乎很合理。因此，参数{% mathjax %}w{% endmathjax %}和{% mathjax %}b{% endmathjax %}对于`Alice`来说似乎是很合理的模型。对于多个用户来说，只需添加一些符号。在这里添加上标`1`，表示用户`1`的参数{% mathjax %}w^{(1)},\;b^{(1)}{% endmathjax %}，这样为数据集上的`4`个用户中的每一个设置不同的参数。将用户{% mathjax %}j{% endmathjax %}对电影{% mathjax %}i{% endmathjax %}的评分预测为{% mathjax %}w^{(j)}\cdot x^{(i)} + b^{(j)}{% endmathjax %}。这里的参数{% mathjax %}w^{(j)}{% endmathjax %}和{% mathjax %}b^{(j)}{% endmathjax %}是用于预测用户{% mathjax %}j{% endmathjax %}对电影{% mathjax %}i{% endmathjax %}评分的参数，{% mathjax %}x^{(i)}{% endmathjax %}是电影{% mathjax %}i{% endmathjax %}的特征。这很像**线性回归**，只是为数据集中的`4`个用户中的每一个拟合不同的线性回归模型。让我们看看如何为该算法制定成本函数。这里注意，如果用户{% mathjax %}j{% endmathjax %}对电影{% mathjax %}i{% endmathjax %}进行了评分，则{% mathjax %}r^{(i,j)} = 1/0{% endmathjax %}。{% mathjax %}y^{(i,j)}{% endmathjax %}用户{% mathjax %}j{% endmathjax %}对电影{% mathjax %}i{% endmathjax %}的评分。这里引入一种新的符号，使用{% mathjax %}m^{(j)}{% endmathjax %}表示用户{% mathjax %}j{% endmathjax %}评分的电影数量。如果用户评分了`4`部电影，则{% mathjax %}m^{(j)} = 4{% endmathjax %}。如果用户评分了`3`部电影，则{% mathjax %}m^{(j)} = 3{% endmathjax %}。预测的**成本函数**为{% mathjax %}\frac{1}{2m^{(j)}}\sum\limits_{i:r(i,j) = 1}(w^{(j)}\cdot x^{(i)} + b^{(j)} - y^{(i,j)})^2{% endmathjax %}。选择参数{% mathjax %}w{% endmathjax %}和{% mathjax %}b{% endmathjax %}来最小化预测评分和观察实际评分之间的**平方误差**。但是用户还没有对所有电影进行评分，如果要对此求和，我们将仅对{% mathjax %}r^{(i,j)} = 1{% endmathjax %}的{% mathjax %}i{% endmathjax %}值求和。意味着用户{% mathjax %}j{% endmathjax %}对该电影{% mathjax %}i{% endmathjax %}进行了评分。最后，对{% mathjax %}m^{(j)}{% endmathjax %}进行归一化为`1`。这类似于用于**线性回归**的**成本函数**。其中对 m(j) mo 求和您对某个评分的评分取平方误差，并用{% mathjax %}\frac{1}{2m^{(j)}}{% endmathjax %}进行归一化。这就是{% mathjax %}w^{(j)},b^{(j)}{% endmathjax %}的成本函数{% mathjax %}\mathbf{J}{% endmathjax %}。如果我们将其最小化，会得到一组相当不错的参数{% mathjax %}w^{(j)}{% endmathjax %}和{% mathjax %}b^{(j)}{% endmathjax %}用于预测用户{% mathjax %}j{% endmathjax %}的评分。再给这个成本函数添加一个项，即防止**过度拟合**的正则化项。即{% mathjax %}\frac{\lambda}{2m^{(j)}}{% endmathjax %}。对于**推荐系统**(`Recommendation system`)来说，{% mathjax %}m^{(j)}{% endmathjax %}只是一个常数。因此，即使把它取出来，也应该得到相同的{% mathjax %}w{% endmathjax %}和{% mathjax %}b{% endmathjax %}值。我们将**最小化成本函数**作为{% mathjax %}w^{(j)}{% endmathjax %}和{% mathjax %}b^{(j)}{% endmathjax %}的函数{% mathjax %}\underset{w^{(j)},b^{(j)}}{\min}\mathbf{J}(w^{(j)},b^{(j)}) = \frac{1}{2m^{(j)}}\sum\limits_{i:r(i,j) = 1}(w^{(j)}\cdot x^{(i)} + b^{(j)} - y^{(i,j)})^2 + \frac{\lambda}{2m^{(j)}}\sum\limits_{k = 1}^n (w_k^{(j)})^2{% endmathjax %}。为了学习所有用户的参数{% mathjax %}w^{(1)}、b^{(1)}、w^{(2)}、b^{(2)}、\ldots、w^{(n_u)}、b^{(n_u)}{% endmathjax %}，则成本函数的计算公式为{% mathjax %}\mathbf{J}\left(\begin{array}{ccc} w^{(1)} &, \ldots &, w^{(n_u)}\\ b^{(1)} &, \ldots &, b^{(n_u)}\end{array}\right) = \frac{1}{2m^{(j)}}\sum\limits_{j=1}^{n_u}\sum\limits_{i:r(i,j) = 1}(w^{(j)}\cdot x^{(i)} + b^{(j)} - y^{(i,j)})^2 + \frac{\lambda}{2m^{(j)}}\sum\limits_{j=1}^{n_u}\sum\limits_{k = 1}^n (w_k^{(j)})^2{% endmathjax %}。这成为学习所有用户的所有参数的成本。如果我们使用**梯度下降法**或其他优化算法将其最小化为{% mathjax %}w^{(1)}、b^{(1)}、w^{(2)}、b^{(2)}、\ldots、w^{(n_u)}、b^{(n_u)}{% endmathjax %}的函数，那么你将拥有一组非常好的参数来预测所有用户的电影评分。请注意，这个算法很像**线性回归**，它的作用类似于**线性回归**的输出{% mathjax %}f(x){% endmathjax %}。只是现在需要为每个用户训练一个不同的**线性回归模型**。将这些特征{% mathjax %}x_1,x_2{% endmathjax %}输入模型，就可以学习参数并预测电影评分。