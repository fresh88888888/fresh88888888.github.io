---
title: 机器学习(ML)(十二) — 推荐系统探析
date: 2024-10-22 15:37:11
tags:
  - AI
categories:
  - 人工智能
mathjax:
  tex:
    tags: 'ams'
  svg:
    exFactor: 0.03
---

#### 概念介绍

**推荐系统**(`Recommendation system`)的链路包括两个重要的步骤：**检索**（称**召回**）和**排名**（分为**粗排**，**精排**和**重排**）**检索**或**召回**主要用于衡量系统从全量信息中找出相关内容的能力。它的核心目的是在用户查询的背景下，尽可能多地返回与之相关的信息。如下图所示：
{% asset_img ml_1.png "推荐系统的链路" %}
<!-- more -->

**推荐系统**(`Recommendation system`)的目标是从物品的数据库中取出几十个物品展示给用户。**推荐系统**链路上的第一环是**检索**或**召回**，就是从数据库中快速取回一些物品，在实践中，**推荐系统**有很多条**召回通道**（如**协同过滤**、**双塔模型**、**关注的作者**等等），每条**召回通道**取回几百个物品。这些**召回通道**一共返回几千个物品，然后**推荐系统**会融合这些物品，并且做去重和过滤，过滤的意思是排除掉不喜欢的物品，召回几千个物品之后，下一步是**排序**，**排序**要用机器学习模型预估用户对物品的兴趣，保留评分最高的物品，如果用一个大规模神经网络逐一对几千个物品打分，花费的代价会很大，为了解决计算量的问题，通常把排序分为**粗排**和**精排**。**粗排**一般使用比较简单的模型，快速给几千个物品打分，保留分数最高的几百个物品；**精排**用一个较大的**神经网络**给几百个物品打分，不用做截断。**精排模型**比**粗排模型**大很多，用的特征也更多，所以**精排模型**打的分数也更可靠。但是**精排模型**的计算量也很大，这就是为什么我们用**粗排模型**先做筛选，然后才用**精排模型**，这样做可以很好的平衡**计算量**和**准确性**。做完**粗排**和**精排**得到几百个物品，每个物品都有一个分数，表示用户多物品的兴趣有多高。可以直接把物品按照打的分数排序，然后展示给用户，但此时的结果还是会存在一些不足，需要做一些调整，这一步叫做**重排**。**重排**主要是考虑**多样性**，要根据多样性进行随机抽样，从几百个物品中选择出几十个物品，然后还要使用规则把相似的物品打散，**重排**的结果就是展示给用户的物品。比如把`top50`的物品（包含广告）展示给用户。如下图所示：
{% asset_img ml_2.png "推荐系统：排序" %}

**精排**与**粗排**的唯一区别就是**精排**用的模型更大，特征更多，模型的输入包括用户特征、物品特征、统计特征。假如要判断用户对某个物品感兴趣，我们就要把该用户的特征、物品的特征和统计特征输入**神经网络**，神经网络会输出很多数值，比如点击率、点赞率、收藏率、转发率等等，这些数值都是神经网络对用户行为的预估。这些数值越大说明用户对该物品越感兴趣，最后把多个预估值做融合，得到最终的分数。比如求加权和，这个分数决定了这个物品会不会展示给用户，以及物品展示的位置是靠前还是靠后，请注意，这只是对一个物品的打分，**粗排**要对几千个物品打分，**精排**要对几百个物品打分。每个物品都用多个预估分数融合成一个分数作为给这个物品排序的依据。**推荐系统**链路上的最后一环是**重排**，重排最重要的能力是**多样性抽样**（比如`MMR`、`DPP`），需要从几百个物品中选出几十个物品。**多样性抽样**的时候有两个依据：一个依据是**精排**分数的大小，另一个依据是**多样性**。做完**多样性抽样**之后会根据规则将相似物品打散。重排的另一个目的是插入广告、运营推广的内容，根据生态要求调整排序。
{% asset_img ml_3.png "精排、粗排" %}

#### A/B测试

