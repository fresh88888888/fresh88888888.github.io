---
title: Stable Diffusion模型—探析（PyTorch）
date: 2024-07-10 18:00:11
tags:
  - AI
categories:
  - 人工智能
mathjax:
  tex:
    tags: 'ams'
  svg:
    exFactor: 0.03
---

`Stable Diffusion`是一种基于扩散模型的文本到图像深度学习模型。该模型于`2022`年推出，由慕尼黑大学`CompViz`集团开发。**基本功能**：文本到图像生成:根据文字描述生成高质量图像；图像编辑:支持内补绘制、外补绘制等图像编辑功能；图像到图像转换:在提示词指导下修改现有图像。**技术架构**：使用潜在扩散模型(`Latent Diffusion Model`)；由三部分组成:变分自编码器(`VAE`)、`U-Net`和文本编码器；在潜在空间中进行扩散过程,提高计算效率。**性能**：生成`512x512`分辨率的图像(`2.0`版本支持`768x768`)；相对轻量级,`U-Net`有`860M`参数,文本编码器有`123M`参数。`Stable Diffusion`的出现标志着AI图像生成技术的重要进步,为创意工作者和普通用户提供了强大的工具。
<!-- more -->

什么是生成模型？生成模型会学习数据集的概率分布，这样我们就可以从该分布中抽样以创建新的数据实例。例如，如果我们有很多猫的图片，并且我们用它训练生成模型，那么我们就可以从这个分布中抽样以创建新的猫图像。为什么我们要将数据建模为分布？假设你是一个罪犯，你想生成数千个虚假身份。每个虚假身份都由变量组成，代表一个人的特征（年龄、身高）。你可以要求政府统计部门提供有关人口年龄和身高的统计数据，然后从这些分布中抽样。
{% asset_img sd_1.png %}

首先，你可以从每个分布中独立抽样来创建一个虚假身份，但这会产生不合理的（年龄，身高）对。要生成有意义的虚假身份，你需要联合分布，否则你最终可能会得到一对不合理的（年龄，身高）。我们还可以使用条件概率和/或通过边缘化变量来评估两个变量之一的概率。我们有一个由图像组成的数据集，我们想要学习一个非常复杂的分布，然后可以用来进行采样。
{% asset_img sd_2.png %}

**证据下界**(`Evidence Lower Bound, ELBO`)是**变分贝叶斯方法**中的一个重要概念，用于估计观测数据对数似然的下限。`ELBO`是一个用于**近似后验分布**的工具。在贝叶斯推理中，我们通常对后验分布感兴趣，但直接计算后验分布通常是不可行，因为需要计算证据（即观测数据的边缘似然），这在大多数情况下是不可计算的。`ELBO`提供了一种变分方法，通过优化一个易处理的下界来近似后验分布。`ELBO`在许多概率推理算法中起着核心作用，如**期望最大化**(`EM`)算法和变分推理。具体应用包括：**变分自编码器**(`VAE`):用于生成模型，学习数据的潜在表示；**贝叶斯神经网络**:用于不确定性估计和模型正则化。
{% asset_img sd_3.png %}

